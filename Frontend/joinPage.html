<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/colyseus.js@^0.14.0/dist/colyseus.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <title>PaintSplat</title>
</head>
<body style="background-color:white;"> 
    <h1>PaintSplat!</h1>
    <form action="./index.html">
        <div class="join-header">
            <label for="username">Username</label>
            <input type="text" id="username" autofocus><br><br>
            <button type="submit" onclick="start_game()" class="button button1">Begin Game!</button>
        </div>
    </form>
    <script>
        var client = new Colyseus.Client('ws://localhost:2567');
        var room_obj;
        var paint_color;
        var colorMap;
        var my_room = client.joinOrCreate("my_room")
        
        my_room.then(room => {

            room_obj = room;

            console.log(room.sessionId, "joined", room.name);

            room.onMessage("joinMessage", (message) => {
                console.log("message received from server");
                console.log(message);
                ({ colorMap, player } = message);
                paint_color = Phaser.Display.Color.HexStringToColor(colorMap[player]).color;
            });     
            room.onMessage("canvas-updated", (message) => {
                console.log("Canvas has been updated.");
                console.log(message);
            });
            
        }).catch(e => {
            console.log("JOIN ERROR", e);
        });
    </script>    
    <script>
    function start_game(){
        
        room_obj.send("startGame");
    }

    </script>
     <!-- <script type="text/javascript" src="javascript/lobby.js"></script> -->
     <!-- <script src="index.js" type="text/javascript"></script>  -->
</body>
</html> 

